---
instance_groups:
- name: nats
  jobs:
    - name: consul_agent
      release: cf
    - name: nats
      release: cf
      provides:
        nats:
          as: nats
          shared: true
    - name: nats_stream_forwarder
      release: cf
    - name: metron_agent
      release: cf
    - name: toolbelt
      release: cf
    - name: toolbelt-quick
      release: cf

meta:
  nats:
    servers: (( grab instance_groups.nats.networks[0].static_ips ))
    user:     nats_user
    password: (( vault meta.vault "/nats:password" ))

properties:
  nats:
    debug: false
    trace: false
    monitor_port: 4221
    prof_port:    0
    port:         4222

    machines: (( grab meta.nats.servers ))
    user:     (( grab meta.nats.user ))
    password: (( grab meta.nats.password ))
